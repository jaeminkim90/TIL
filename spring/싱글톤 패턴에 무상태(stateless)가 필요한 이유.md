> ### ğŸ“– âœï¸ 
> 1. **TIL ì‹œë¦¬ì¦ˆì— ì‘ì„±ëœ ê¸€ì€ 'ë§¤ì¼ ë§¤ì¼ í•™ìŠµí•œ ì§€ì‹ ì¡°ê°ì„ ë©”ëª¨í•´ ë†“ì€ í¬ìŠ¤íŒ…'ì…ë‹ˆë‹¤. ê³µìœ ê°€ ì•„ë‹Œ ê°œì¸ì ì¸ í•™ìŠµ ë‚´ìš© ê¸°ë¡ì„ ëª©ì ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.**
> 2. ê·¸ ì™¸ ì‹œë¦¬ì¦ˆì— ì‘ì„±ëœ **ê³µìœ  ëª©ì ì˜ í¬ìŠ¤íŒ…**ì€ ì‹œê°„ì´ ë‚  ë•Œë§ˆë‹¤ ë³„ë„ë¡œ ì‘ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì£¼ë¡œ, TIL ì‹œë¦¬ì¦ˆì— ì‘ì„±ëœ ë‚´ìš©ì—ì„œ **íŠ¹ì • ì£¼ì œë¥¼ ì„ ì •í•˜ê³ , ë” ê¹Šì´ ê³µë¶€í•œ í›„ ì •ë¦¬í•˜ì—¬ ì‘ì„±í•©ë‹ˆë‹¤.**

---

# ì‹±ê¸€í†¤ íŒ¨í„´ì— ë¬´ìƒíƒœ(stateless)ê°€ í•„ìš”í•œ ì´ìœ 

ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš© í•  ë•Œ, ì£¼ì˜í•  ì ì€ ê°ì²´ì˜ ìƒíƒœë¥¼ ìœ ì§€(stateful)í•˜ëŠ” ì„¤ê³„ë¥¼ ë°˜ë“œì‹œ í”¼í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì‹±ê¸€í†¤ ë°©ì‹ì€ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•˜ë‚˜ë§Œ ìƒì„±í•˜ê³  ê³µìœ í•˜ì—¬ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ê³µìœ í•˜ê²Œ ëœë‹¤. ì´ë•Œ ë¬´ìƒíƒœ(stateless)ê°€ ì•„ë‹ˆë¼ë©´, í•˜ë‚˜ì˜ ê°ì²´ê°€ ê°–ëŠ” ìƒíƒœë¥¼ ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ê³µìœ í•˜ëŠ” ê²°ê³¼ê°€ ìƒê¸´ë‹¤.

ë”°ë¼ì„œ, ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ëŠ” ë°˜ë“œì‹œ ë¬´ìƒíƒœ(stateless)ë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤. ë¬´ìƒíƒœ(stateless)ë€ ìƒíƒœë¥¼ ê³µìœ í•˜ëŠ” í•„ë“œ ë³€ìˆ˜ê°€ ì—†ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ê°€ ì˜ì¡´í•  ìˆ˜ ìˆëŠ” í•„ë“œ ë³€ìˆ˜ê°€ ì¡´ì¬í•˜ë©´ ì•ˆëœë‹¤. ë‹¹ì—°íˆ ê°’ì„ ë³€ê²½í•  ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤. ê°€ëŠ¥í•œ ë©”ì„œë“œë¥¼ ì´ìš©í•´ ê°’ì„ ì½ê¸°ë§Œ í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. 

ì‹±ê¸€í•„ë“œ ë³€ìˆ˜ ëŒ€ì‹  ê³µìœ ë˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ì¢‹ë‹¤. ì§€ì—­ ë³€ìˆ˜, íŒŒë¼ë¯¸í„°, ThreadLocalì´ ì´ì— í•´ë‹¹í•œë‹¤. ìŠ¤í”„ë§ ë¹ˆì˜ í•„ë“œì— ê³µìœ ë˜ëŠ” ë³€ìˆ˜ê°€ ì¡´ì¬í•˜ë©´ ì„œë¹„ìŠ¤ì— í° ë¬¸ì œê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ í¬ë‹¤.

ì•„ë˜ ì˜ˆì‹œ ì½”ë“œë¥¼ í†µí•´ ì–´ë–¤ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸í•´ë³´ì.

> **ìƒíƒœê°€ ìˆëŠ”(stateful) í´ë˜ìŠ¤**
>í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ì˜í•´ `StatefulService` ê°ì²´ê°€ ì—¬ëŸ¬ê°œ ìƒì„±ëœ ìƒí™©ì´ë‹¤. `StatefulService` ê°ì²´ëŠ” `order()`ë¥¼ í†µí•´ í•„ë“œ ë³€ìˆ˜ì— `price`ë¥¼ ë„£ì„ ìˆ˜ ìˆê³ , `getPrice()`ë¥¼ í†µí•´ `price`ì„ ì¡°íšŒí•  ìˆ˜ìˆë‹¤.

```java
public class StatefulService {

    private int price; // ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” í•„ë“œ

    public void order(String name, int price) {
        System.out.println("name = " + name + " / price = " + price );
        this.price = price; // ì—¬ê¸°ê°€ ë¬¸ì œ!
    }

    public int getPrice() {
        return price;
    }
}
```

> **ìƒíƒœê°€ ìˆëŠ”(stateful) ê°ì²´ë¥¼ ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ ì¡°íšŒí•  ë•Œ ë°œìƒí•˜ëŠ” ë¬¸ì œ**
>ë¬¸ì œëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì´ í•˜ë‚˜ì˜ ê°ì²´ë§Œì„ ìƒì„±í•˜ê³ , ê³µìœ í•˜ì—¬ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ê°€ priceë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. ìƒíƒœë¥¼ ê³µìœ í•˜ë¯€ë¡œ, íŠ¹ì • í´ë¼ì´ì–¸íŠ¸ì˜ priceë¥¼ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤. ì•„ë˜ ì˜ˆì‹œ ì½”ë“œì™€ ê°™ì´ A ì‚¬ìš©ìì˜ priceê°€ B ì‚¬ìš©ìì˜ priceë¡œ ë³€ê²½ë  ìˆ˜ ìˆë‹¤.


```java
class StatefulServiceTest {

    @Test
    void statefulServiceSingleton() {
     ApplicationContext ac = new AnnotationConfigApplicationContext(TestConfig.class);

        StatefulService statefulService1 = ac.getBean(StatefulService.class);
        StatefulService statefulService2 = ac.getBean(StatefulService.class);

        // ThreadA: A ì‚¬ìš©ì 10000ì› ì£¼ë¬¸
        statefulService1.order("userA", 10000);

        // ThreadB: B ì‚¬ìš©ì 20000ì› ì£¼ë¬¸
        statefulService1.order("userA", 20000);

        // ThreadA: ì‚¬ìš©ì A ì£¼ë¬¸ ê¸ˆì•¡ ì¡°íšŒ
        int price = statefulService1.getPrice();
        System.out.println("price = " + price); // 20000ì›ì´ ë‚˜ì˜¨ë‹¤. B ì‚¬ìš©ìë¡œ ì¸í•´ ìƒíƒœê°’ ë³€ê²½

        // statefulService1ì˜ priceì™€ statefulService2ì˜ priceê°€ ë™ì¼í•´ì§€ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤. 
        Assertions.assertThat(statefulService1.getPrice()).isEqualTo(statefulService2.getPrice());
    }

    static class TestConfig {

        @Bean
        public StatefulService statefulService () {
            return new StatefulService();
        }
    }
}
```

---

## ìš”ì•½

- í•˜ë‚˜ì˜ ê°ì²´ë¥¼ ê³µìœ í•˜ëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì˜ íŠ¹ì„±ìƒ ìƒíƒœê°€ ê³µìœ ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. 
- í´ë¼ì´ì–¸íŠ¸ë§ˆë‹¤ ê³ ìœ í•œ ê°’ì´ ë’¤ì„ì´ëŠ” ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš©í•œë‹¤ë©´ ë°˜ë“œì‹œ ë¬´ìƒíƒœë¡œ ì„¤ê³„í•´ì•¼ í•œë‹¤.
- ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ìŠ¤í”„ë§ ë¹ˆì€ í•­ìƒ ë¬´ìƒíƒœ(stateless) ì„¤ê³„ê°€ í•„ìš”í•˜ë‹¤. 